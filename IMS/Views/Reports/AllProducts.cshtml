@model IEnumerable<dynamic>

@{
    ViewData["Title"] = "All Products Report";
}

<link rel="stylesheet" href="https://cdn.datatables.net/1.13.6/css/dataTables.bootstrap5.min.css" />
<link rel="stylesheet" href="https://cdn.datatables.net/buttons/2.4.1/css/buttons.bootstrap5.min.css" />

<div class="page-heading mb-4">
    <h3 class="fw-bold text-primary">@ViewData["Title"]</h3>
    <p class="text-muted">All product details with export and filtering options</p>
</div>

<div class="card shadow-sm">
    <div class="card-header d-flex justify-content-between align-items-center">
        <h5 class="mb-0 text-secondary">Product List</h5>
        <div>
            <a href="/Reports/ExportToExcel" class="btn btn-success btn-sm me-2">
                <i class="bi bi-file-earmark-excel"></i> Excel
            </a>
            <a href="/Reports/ExportToPdf" class="btn btn-danger btn-sm">
                <i class="bi bi-file-earmark-pdf"></i> PDF
            </a>
        </div>
    </div>

    <div class="card-body">
        <div class="table-responsive">
            <table id="productsTable" class="table table-striped table-bordered align-middle">
                <thead class="table-light">
                    <tr>
                        <th>Product Name</th>
                        <th>Category</th>
                        <th>Vendor</th>
                        <th>Quantity</th>
                        <th>Cost Price</th>
                        <th>Sale Price</th>
                    </tr>
                    <!-- 🔍 Filter Row -->
                    <tr>
                        <th><input type="text" placeholder="Search Product" class="form-control form-control-sm" /></th>
                        <th><input type="text" placeholder="Search Category" class="form-control form-control-sm" /></th>
                        <th><input type="text" placeholder="Search Vendor" class="form-control form-control-sm" /></th>
                        <th><input type="text" placeholder="Search Qty" class="form-control form-control-sm" /></th>
                        <th><input type="text" placeholder="Search Cost" class="form-control form-control-sm" /></th>
                        <th><input type="text" placeholder="Search Sale" class="form-control form-control-sm" /></th>
                    </tr>
                </thead>
                <tbody>
                    @foreach (var p in Model)
                    {
                        <tr>
                            <td>@p.ProductName</td>
                            <td>@p.Category</td>
                            <td>@p.Vendor</td>
                            <td>@p.Quantity</td>
                            <td>@p.CostPrice</td>
                            <td>@p.SalePrice</td>
                        </tr>
                    }
                </tbody>
            </table>
        </div>
    </div>
</div>

@section Scripts {
    <script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
    <script src="https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/1.13.6/js/dataTables.bootstrap5.min.js"></script>
    <script src="https://cdn.datatables.net/buttons/2.4.1/js/dataTables.buttons.min.js"></script>
    <script src="https://cdn.datatables.net/buttons/2.4.1/js/buttons.bootstrap5.min.js"></script>
    <script src="https://cdn.datatables.net/buttons/2.4.1/js/buttons.html5.min.js"></script>

    <script>
        $(document).ready(function () {
            // ✅ DataTable initialization
            var table = $('#productsTable').DataTable({
                pageLength: 10,
                orderCellsTop: true,
                fixedHeader: true
            });

            // ✅ Apply column filters
            $('#productsTable thead tr:eq(1) th').each(function (i) {
                $('input', this).on('keyup change', function () {
                    if (table.column(i).search() !== this.value) {
                        table
                            .column(i)
                            .search(this.value)
                            .draw();
                    }
                });
            });
        });
    </script>
}
